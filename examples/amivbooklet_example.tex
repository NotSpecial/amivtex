% The path to amivtex files, for the example just the parent folder
\newcommand{\amivtexlocation}{../}

% Needed to make \input work from a different directory
\makeatletter
\def\input@path{{\amivtexlocation}}
\makeatother

\documentclass[twoside, 9pt]{extarticle}

\usepackage[xetex, a5paper, top=0cm, includehead, headheight=10mm, headsep=12mm,%
		    left=1cm, right=0cm, includemp, marginparsep=12mm, marginparwidth=8mm]{geometry}

\usepackage{fontspec}
\setmainfont{DINPro}
\setsansfont{DINPro}

%\usepackage[onehalfspacing]{setspace}

\usepackage{graphicx}

%\usepackage{float}

\usepackage{xcolor}    
\definecolor{copperred}{rgb}{0.910, 0.274, 0.169}
\definecolor{petrolblue}{rgb}{0.122, 0.176, 0.329}

% Use fancyhdr to create a colored box at the top of the page

\newcommand{\amivbox}[5][black]{% Textcolor (optional), Boxcolor, Width, Height, Content
	\colorbox{#2}{%
		\begin{minipage}[c][#4]{#3}
			\makebox[\textwidth]{\large \color{#1}\textbf{#5}}
		\end{minipage}%
	}%
}

%Use marginnotes to create boxes at the border
\usepackage{marginnote}

% Detect odd/even pages
\usepackage{changepage}
\newcommand{\rot}{\ifoddpage 90\else -90\fi}

\newlength{\sideboxheight}
\setlength{\sideboxheight}{2cm}
\newcommand{\sidebox}[3][black]{%  text color (black), box color, text 
	\checkoddpage  % required for \rot to have correct value
	\amivbox[#1]{#2}{0.6cm}{\sideboxheight}{\rotatebox{\rot}{#3}}
}
\newcommand{\boothbox}[1]{\marginnote{\sidebox{copperred}{#1}}[0cm]}
\newcommand{\itet}{\marginnote{\sidebox[white]{petrolblue}{ITET}}[\dimexpr 1\sideboxheight + 3em]}
\newcommand{\mavt}{\marginnote{\sidebox[white]{petrolblue}{MAVT}}[\dimexpr 2\sideboxheight + 4em]}
\newcommand{\mtec}{\marginnote{\sidebox[white]{petrolblue}{MTEC}}[\dimexpr 3\sideboxheight + 5em]}

\usepackage{fancyhdr}
\pagestyle{fancy}
% Remove content and separating line
\fancyhf{}
\renewcommand{\headrulewidth}{0pt}
% Set blue bar in top header, the makebox[0pt][c] is needed to absolutely center on page
\fancyhead[c]{\makebox[0pt][c]{\amivbox{petrolblue}{1.2\paperwidth}{\headheight}{}}}
\fancyfoot[EL, OR]{\color{copperred} \thepage}

% Internal Variables
\newcommand{\companyname}{}
\newcommand{\companywebsite}{}
\newcommand{\companybooth}{}
\newcommand{\companylogo}{}
\newcommand{\companyboxes}{}
\newcommand{\companycontact}{}
\newcommand{\companyemployees}{}
\newcommand{\companyoffers}{}
\newcommand{\companyabout}{}
\newcommand{\companyfocus}{}

% Provide commands to set company info easily
\newcommand{\name}[1]{\renewcommand{\companyname}{#1}}
\newcommand{\website}[1]{\renewcommand{\companywebsite}{#1}}
\newcommand{\booth}[1]{\renewcommand{\companybooth}{#1}}
\newcommand{\logo}[1]{\renewcommand{\companylogo}{#1}}
\newcommand{\boxes}[1]{\renewcommand{\companyboxes}{#1}}
\newcommand{\contact}[1]{\renewcommand{\companycontact}{#1}}
\newcommand{\employees}[1]{\renewcommand{\companyemployees}{#1}}
\newcommand{\offers}[1]{\renewcommand{\companyoffers}{#1}}
\newcommand{\about}[1]{\renewcommand{\companyabout}{#1}}
\newcommand{\focus}[1]{\renewcommand{\companyfocus}{#1}}

% Create a companypage
\newcommand{\companypage}{%
\clearpage  % start on new page
% Sidebar
\boothbox{\companybooth}
\companyboxes
% Company Info
\begin{minipage}[t][0.4\textheight]{0.5\textwidth}
	\vspace{0pt}  % The minipages will be aligned by the first line, insert an empty line to make it pretty
	\textbf{\Large \color{copperred} \companyname }\\
	\companywebsite
	\bigbreak
	\textbf{KONTAKT FÜR STUDIERENDE}\\
	\companycontact
	\medbreak
	\textbf{MITARBEITENDE}\\
	\companyemployees
	\medbreak
	\textbf{ANGEBOTE}\\
	\companyoffers
\end{minipage}%
% Logo
\begin{minipage}[t][0.4\textheight]{0.5\textwidth}
	\vspace{0pt}  % The minipages will be aligned by the first line, insert an empty line to make it pretty
	\centering
	\includegraphics[width=\textwidth, height=0.4\textheight, keepaspectratio]{\companylogo}
\end{minipage}

% Text, use minipage to keep it on one page
\begin{minipage}[t][0.55\textheight][t]{\textwidth}
	\textbf{\large \color{copperred} Über uns }
	\smallbreak
	\companyabout
	\bigbreak
	\textbf{\large \color{copperred} Schwerpunkte }
	\smallbreak
	\companyfocus
\end{minipage}
}



% Generate random text for demo purposes
\usepackage{blindtext}


\begin{document}
\setlength{\parindent}{0pt}

\name{Sensirion AG}
\website{www.sensirion.com}
\booth{A2}
\logo{amiv.png}
\boxes{\itet\mavt\mtec}
\contact{Marco Höhener\\+41 44 927 11 96\\www.xing.to/Marco\_Hoehener}
\employees{520 in der Schweiz\\600 in der Welt}
\offers{Praktika\\Festanstellungen}
\about{\blindtext}
\focus{\blindtext}

\companypage

\name{Other AG}
\website{www.other.com}
\booth{A5}
\logo{amiv.png}
\boxes{\itet\mtec}
\contact{Marco Höhener\\+41 44 927 11 96\\www.xing.to/Marco\_Hoehener}
\employees{520 in der Schweiz\\600 in der Welt}
\offers{Praktika\\Festanstellungen}
\about{\blindtext}
\focus{\blindtext}

\companypage

\end{document}

\ProvidesPackage{kontaktutils}

% Make contract sections paragraphs 
\renewcommand*{\thesection}{\S\ \arabic{section}}

% Reset counting with every letter to support several per document
\AtBeginLetter{\setcounter{section}{0}}

% Set kontact settings
\newcommand{\fairtitle}{AMIV Kontakt.16}
\newcommand{\amivsectionname}{Kommission Kontakt}
\newcommand{\amivsectionpresident}{Alexander Ens}
\renewcommand{\amivemail}{kontakt@amiv.ethz.ch}
\renewcommand{\amivlogo}{kontakt_dark_background.png}

% Create commands so they can be renewed for every letter
\newcommand{\companyname}{}
\newcommand{\companyaddress}{}
\newcommand{\companycity}{}
\newcommand{\companycountry}{}
\newcommand{\companyrepresentative}{}
\newcommand{\boothchoice}{}
\newcommand{\datechoice}{}
\newcommand{\extrachoice}{}

% Booth descriptions and info, command format: \sizeKATnumberofdays
% Exceptions startup, they have no category
% Small booths
\newcommand{\smallAone}{Kleiner Stand, Kategorie A, ein Messetag}
\newcommand{\smallAtwo}{Kleiner Stand, Kategorie A, zwei Messetage}
\newcommand{\smallBone}{Kleiner Stand, Kategorie B, ein Messetag}
\newcommand{\smallBtwo}{Kleiner Stand, Kategorie B, zwei Messetage}
% big booths,
\newcommand{\bigAone}{Grosser Stand, Kategorie A, ein Messetag}
\newcommand{\bigAtwo}{Grosser Stand, Kategorie A, zwei Messetage}
\newcommand{\bigBone}{Grosser Stand, Kategorie B, ein Messetag}
\newcommand{\bigBtwo}{Grosser Stand, Kategorie B, zwei Messetage}
% startups
\newcommand{\startupone}{Startup-Stand, ein Messetag}
\newcommand{\startuptwo}{Startup-Stand, zwei Messetage}

\newcommand{\bigboothinfo}{%
	\begin{enumerate}
		\item Abmessungen Standplatz: 500cm x 220cm
		\item Zwei Tische oder ein Tisch und zwei Stehtische oder vier Stehtische
		\item Zwei Stellwände (je 120cm x 180 cm)
	\end{enumerate}
}

\newcommand{\smallboothinfo}{%
	\begin{enumerate}
		\item Abmessungen Standplatz: 250cm x 220cm
		\item Ein Tisch oder zwei Stehtische
		\item Eine Stellwand (120cm x 180 cm)
	\end{enumerate}
}

\newcommand{\mediainfo}{{%
	\footnotesize Inserat im Messeführer (A5, farbig)\\
	Ein frei gestaltbarer Facebook Post Ihrer Firma
	auf der Kontakt.16 Facebook-Seite
}}

\newcommand{\businessinfo}{{%
	\footnotesize Erwähnung als Partner auf der Startseite der Kontakt-Website\\
	Ganzjähriges Firmenprofil auf der Kontakt-Website\\
	Ganzseitiges Inserat in der Studentenzeitschrift des AMIV (Blitz) vor der Messe
}}

\newcommand{\firstinfo}{{%
	\footnotesize Erwähnung als Partner auf der Startseite der Kontakt-Website\\
	Ganzjähriges Firmenprofil auf der Kontakt-Website\\
	Ganzseitiges Inserat in der Studentenzeitschrift des AMIV (Blitz) vor der Messe\\
	Frei wählbarer Standplatz\\
	Ihr Firmenlogo erscheint prominent auf allen Werbeplakaten
}}

% Helper to create cover letter
\newcommand{\makecoverletter}{%
	\setkomavar{subject}{Vertrag zur \fairtitle}
	\setkomavar{location}{\locationcontent}
	\KOMAoptions{%
		backaddress=plain,
		addrfield=true,
	}

	\begin{letter}{%
		\companyname\\
		\companyrepresentative\\
		\companyaddress\\
		\companycity\\
		\companycountry
	}

		\opening{Sehr geehrte Damen und Herren,}

		wir freuen uns, dass \companyname\ an der diesjährigen Kontakt teilnehmen wird.
		\bigbreak\noindent
		Anbei senden wir Ihnen den Standvertrag in doppelter Ausführung. 
		Wir bitten Sie, eine Version unterzeichnet an uns zu retournieren.
		\bigbreak\noindent
		Bei allen Anliegen oder Fragen stehen wir Ihnen gerne zur Verfügung.
		\bigbreak
		\closing{Mit freundlichen Grüssen}

		\encl{Standvertrag in doppelter Ausführung}

	\end{letter}
}%

% Helper to create contract itself
\newcommand{\makecontract}{
	\setkomavar{subject}{}
	\setkomavar{location}{}

	\KOMAoptions{
		backaddress=off,
		addrfield=false,
	}

	\begin{letter}{}
		\opening{}
		\input{kontakt_contract_text.tex}
	\end{letter}
}%
